19:19:56 WARNING  is when this event was logged.
19:19:56 INFO     
        DROP TABLE IF EXISTS optimal_plant_costs;
CREATE TABLE optimal_plant_costs AS
        WITH
        costs AS
        (
            SELECT id_aggregate, id_target, id_building, rank, length, plant_capacity, manure, crop_production, live_methane, crop_methane,
            (crop_production * 5) AS cost_harvest,
            ((length / 1000) * crop_production * 6) AS cost_ensiling,
            ((length / 1000) * manure * 0.2) AS cost_manure
            FROM optimal_plant_residual
            WHERE plant_capacity <= 100
        ),
        total AS (
            SELECT *,
            CASE
                WHEN cost_manure is not null THEN cost_manure + cost_harvest + cost_ensiling
                ELSE cost_harvest + cost_ensiling
            END AS cost_100kw,
            COALESCE (live_methane, 0) + crop_methane AS methane_100kw
            FROM costs
        )
        SELECT id_aggregate, id_target, id_building, rank, length, plant_capacity, manure, crop_production, live_methane, crop_methane, methane_100kw, cost_100kw
        FROM total
        WHERE plant_capacity <= 100
            ;
    
