DROP TABLE IF EXISTS tmp_dijkstra_test;
CREATE TABLE tmp_dijkstra_test AS

WITh
    dijkstra as (
	SELECT
	    1 as id_target, dijkstra.*, topo_roads_noded.geom
	FROM	pgr_dijkstra(
		'SELECT id, source::integer, target::integer, distance::double precision AS cost FROM topo_roads_noded',
		102286, array[207139,398552,449500,384358,259682,287216,259488,426686,464030,213811,358900,254161,264785,440763,197298,410134,416743,460216,232910,250019,267429,252082,93025,92368,404781,262130,441098,444590,334434,427942,265800,93739,422866,228828,265274,207925,243294,228693,209654,406222,188883,261349,266693,24778,217525,438387,248241,404212,464140,445661,284908,168003,266661,251232,171608,214224,201494,93125,258185,459625,212245,24570,395958,415927,239103,264946,380055,24637,206742,465162,242712,223154,460084,459928,458821,189726,294471,172317,440012,262974,390545,410975,91280,230329,319890,250574,419207,445399,328426,428412,169747,396903,407126,439095,399130,195350,243770,213819,38318,458701,423245,196200,240114,408819,349270,231728,427709,440397,251501,194155,91642,440967,428066,381195,226650,438410,224254,420137,250746,458582,239996,39147,212185,465158,257178,256962,91471,439982,195691,395015,427626,212567,385665,92429,168109,214744,380153,186691,286400,394986,255494,428539,459265,191504,259599,171334,250928,242770,465349,425179,405662,265818,232724,358847,464499,233030,242873,381382,444936,227998,208167,390311,212255,404918,399743,387129,411903,234065,228782,427275,24451,267012,445607,336418,213565,416842,459069,228308,210151,444331,407321,386396,417692,189319,169398,99294,167245,171416,244683,355662,253277,208131,428377,427666,228950,463576,376954,380839,403971,445435,421462,239808,384235,290041,267062,416976,263298,459479,23898,287728,211351,258113,38724,259667,39463,168873,406855,172618,211103,459434,389350,214219,438955,427988,268035,381440,249690,233061,428672,252698,258363,399886,394189,459686,186573,228754,232666,413413,193514,229251,264757,264049,294362,263039,182884,186155,91301,253478,381022,99384,293121,245110,278412,95293,206402,257158,440915,387304,251419,39479,168674,223442,465196,250691,256937,232321,265558,464004,225392,339279,193051,219326,463368,259612,404706,463220,294981,363785,237722,393246,258263,448136,231428,268520,200224,415372,17116,209974,344712,24377,255362,261478,420187,234736,232480,260251,427476,210841,91369,259712,250915,421199,396560,405004,256179,402267,449250,287388,428103,211756,238622,182846,259192,363196,407314,39951,439774,427479,396698,242736,25713,189830,259884,344357,200424,251160,287159,166504,269315,416195,234891,440819,170201,262889,436659,418220,404830,265881,208073,185251,237316,189944,394225,261453,285852,406147,448159,220317,188614,417193,228999,464652,400647,262035,25245,190296,222065,239462,211311,417227,205709,265249,440805,36172,260902,229859,294899,187369,458945,252788,358884,249687,219563,200191,232394,264407,24255,206958,396415,284415,259774,344397,267787,250873,399759,385652,220752,26365,260905,168663,196057,445308,197088,227958,261278,267879,250692,356919,265147,24711,417696,213654,405907,448592,382627,449515,270855,211926,287694,459806,242094,95260,415730,268760,99306,172036,384255,256605,464112,379508,259155,205718,256046,382469,444287,250678,383717,409462,428458,245406,205422,461386,460692,425194,230812,229148,357531,409512,230979,39301,228482,228001,244439,339232,427330,439002,17127,248707,231730,187833,462518,261565,386513,259595,212697,458858,259245,417145,397112,419932,421078,406326,242957,266651,229555,287804,181016,23880,286564,259234,257077,223489,183143,207607,189222,233170,186601,457878,253258,463557,444219,435998,404823,198020,346113,230877,220795,393711,195932,404379,428602,206670,224787,245267,183021,259000,324073,211696,230605,190011,212616,170638,459042,383807,268321,269573,207848,393746,170796,264306,183084,460532,394172,259419,214280,404875,463244,240322,200869,187956,422191,230776,420227,276644,428029,160304,458063,463510,229575,170954,219864,286855,91502,428504,465187,255932,399454,199540,254845,464687,464846,343741,194052,359222,357293,218490,269173,393236,449411,235852,386525,285771,207021,275171,251457,393816,388440,361428,181134,266292,25112,458009,38917,460263,23973,230003,394821,205614,379238,402265,169629,33237,384541,182116,243777,465003,253729,231444,380046,414605,259357,259845,97681,166905,458803,417712,183589,362432,420275,259024,458142,344756,223608,98470,214751,257832,172415,427482,458782,287464,266669,423627,445724,212172,91267,257218,394815,219464,262102,394796,459663,228794,186772,269267,421470,267994,255366,228674,267342,256668,211631,235071,228545,386195,276678,287218,206448,244346,237848,243603,259262,435973,445753,237591,459555,250039,406204,464571,459183,388318,444351,405061,385627,416805,193445,207628,225765,186741,172174,226686,293307,227245,229241,182100,279449,222797,289194,452412,260719,237556,251257,215759,400273,150850,279447,380402,247901,405868,172536,259048,394866,39638,171709,262800,248668,264993,387394,427309,287367,265403,187509,427397,286905,21044,278423,258796,218125,420362,258341,189661,188121,393783,252624,252708,220364,269231,268225,256193,427315,39282,239234,186785,261182,228186,440834,320503,216424,180789,25778,232373,460261,385505,204732,244633,241843,259083,364793,26064,267782,224491,43496,201069,248664,415991,99570,406298,415745,256769,23959,231523,205923,91995,223014,206743,265860,242241,428692,24133,389899,457943,169371,268620,282883,263202,437139,462399,424787,415287,392496,434087,459116,340531,380112,465295,230653,42472,437498,382929,415515,348707,416780,250266,231387,458747,460919,24696,453321,237802,390955,400545,91455,254028,427780,264178,364301,38662,259906,385494,382725,218439,200667,201616,208137,266386,265089,213126,259322,458072,285779,459632,463980,253280,214724,187780,266413,463828,229598,190801,414181,199286,220452,266242,234935,400610,440627,427648,292671,463672,440957,126420,294552,362534,385467,463680,287435,410032,265425,415932,419904,386015,467417,242662,261368,440429,391048,417585,387336,458244,404438,380138,262746,387168,444088,190285,462445,266417,427407,417804,458119,210939,245731,387125,239005,195942,203741,199160,423319,285867,220979,192878,448166,261136,196665,259486,416811,392524,257125,404426,230067,195565,244358,223801,219655,465206,458286,459249,444630,267839,190996,404002,460358,440708,427305,200860,38228,186201,252922,428700,286324,220667,192997,246476,199397,213789,172180,93120,262790,227754,231062,286795,206932,290238,376225,427320,398789,227225,416276,213420,379981,396461,445789,184190,261004,465178,10212,201492,458257,243370,402268,224498,266524,268265,259296,39264,433851,229138,259480,439293,445196,449426,287683,168065,171653,444727,464464,439958,92583,93132,260742,361965,428090,213430,386013,257943,382450,214947,38934,428389,181068,440818,465227,403960,170948,379527,39296,390878,172117,439579,262773,458755,460256,427612,385488,193332,239733,243172,187845,245599,256205,294541,387939,228643,256816,264834,266860,234717,268861,240448,168694,220449,256888,266371,212099,91435,261611,400509,447812,242543,261678,319297,182841,417109,228831,458892,459707,464519,290089,237716,267365,259250,253073,259288,211869,235751,235059,419433,250759,448583,265007,261325,401424,465172,265235,428792,248350,415306,394163,160630,25804,190780,337205,267518,234585,460647,209998,464664,406977,263456,418837,261064,221426,389814,444129,192228,413340,405686,420291,239944,382863,243732,364565,184477,417556,463790,284748,284911,413837,294287,251024,25763,440385,363639,190778,275164,427430,268660,463981,261915,219303,261712,465275,266288,192468,386219,268774,259146,263352,261020,259876,201128,264688,379722,389561,268022,171877,184161,464838,245317,250907,34717,393766,428710,267545,257475,458027,182066,25338,229132,392070,246560,258565,219633,250169,35101,181059,400261,188301,380080,459737,344855,191563,219739,420213,395998,404896,269552,267355,444627,381199,264016,459041,232682,268078,446597,237500,266917,459130,255626,213103,358971,344187,383335,225041,39403,269473,194633,384065,219665,348651,350734,458430,460562,230619,445106,344425,464503,285814,287154,437611,192846,234832,245709,97586,206596,198467,212176,267466,417634,223039,417701,212171,390871,207619,250533,253306,216763,465512,436546,357187,241769,190062,208254,25356,287451,465128,227997,196048,406373,33528,207604,242606,194540,265117,364221,266823,269731,235227,458749,223826,404876,24797,459138,258471,396676,413346,428378,212178,285436,95956,405607,260798,240287,396702,427369,210662,382786,186163,199733,254776,265803,294374,457998,462454,419963,246029,392707,232745,364189,465099,288039,460716,391314,255737,182142,406119,245555,211421,278430,417762,400634,387006,287457,265567,418243,205827,427973,269584,245806,190300,207521,417646,265408,45374,257134,269712,420615,416352,28114,170820,206127,446613,203874,208069,405371,444921,287454,196588,261305,379210,376180,193621,285699,241798,267768,259216,24164,386285,25611,182200,189637,92000,269670,201557,327997,186687,254122,223172,380204,400012,292535,344789,258424,191412,427463,243464,361530,226086,219791,234952,250985,422842,413308,245331,428296,408101,213780,317462,418541,400362,278451,213602,238700,208103,24767,265103,459198,261964,92786,393568,126249,209168,465294,419994,396900,343284,261727,192482,463653,440802,223821,404202,404882,463967,201704,170314,266909,170263,254640,465400,258977,250561,187280,270848,243902,267683,95285,251643,170431,268217,218344,168784,457795,460004,457803,269777,415477,193406,212309,225772,228757,328429,256898,257057,212706,183001,387334,206764,187609,452843,208152,393839,207671,167706,460181,229977,237604,167900,405786,241941,206422,445296,238940,232451,259914,427410,239321,205972,197330,171142,415451,459093,263496,195974,417488,405919,449392,428738,49306,230769,452432,294917,410938,242755,267878,253056,433575,249975,214715,257103,387130,286092,458842,194442,214250,411681,364652,189655,267963,235090,230457,191865,181737,404482,464700,237498,423398,235020,266486,261943,213825,406266,200165,260037,408249,263399,294673,252659,266642,417382,99175,250406,459046,230546,258434,458587,416926,287641,250568,359090,404730,39475,171978,188709,405830,344834,200691,427254,242600,448021,251004,230716,404385,267885,261079,445007,33194,247352,383187,424843,253736,391029,255308,359346,189671,405783,254137,383602,405610,415458,396910,255819,405905,269744,188547,439928,266322,396886,415381,170709,191464,38433,109465,234945,234661,223537,258315,380417,264132,193525,381153,312666,193885,228551,233562,459838,252584,187831,275229,265335,290077,169103,261434,237653,256007,242912,269808,381397,212274,416607,447755,458035,265272,420283,265353,460479,410172,257026,322936,208241,171881,285321,382352,243200,184158,256076,255067,36293,216851,171755,460790,258990,427485,461430,239035,404927,92597,379732,244572,381089,38946,172673,213092,447875,395488,228354,279553,401151,268211,395772,24809,390302,361262,237437,92724,362465,428259,256503,211253,249644,229078,287436,415391,245576,265077,82690,200914,395351,260680,423095,207693,405496,440743,458204,401194,445525,260159,190538,227784,167845,171216,405040,460637,194325,245416,261972,444146,444717,406324,25141,40107,167839,227120,40315,185135,263671,287995,265172,269630,364632,262612,204783,95959,267261,440033,231365,405472,416757,385641,268919,259337,25908,211271,186672,218426,404403,421143,212562,245472,379502,287849,447734,212421,265351,422783,465287,193356,387360,256617,263262,221487,250225,167935,382259,229023,421906,261216,428612,444202,186753,287572,186999,259078,440683,202527,379997,170679,257493,212289,206505,190316,252620,458163,387669,183389,356981,449431,187820,237704,379754,293242,268703,420119,241648,228497,214733,338949,404261,187484,253248,39432,465526,275698,269720,269766,382365,259756,428650,166802,229186,186731,428630,463435,265372,462472,230946,228570,393888,405071,422510,261670,168267,215777,453621,463909,211555,268884,109492,44573,267956,253995,226600,182992,255848,428600,413475,243020,243825,398948,222891,248942,192512,212489,95145,256878,264268,192949,404774,191667,436586,284916,189821,410981,250075,415946,458549,170600,227031,406913,461963,25072,414081,385582,389885,259211,243273,415948,420248,258256,383402,195873,396684,201728,379227,231073,458058,260604,220566,439430,313236,181738,286229,384278,458628,329984,287883,260656,192542,192448,251527,227054,428645,168234,465302,410576,459539,394253,181847,396568,168309,463965,275338,251239,201489,290262,232692,239911,458573,187838,192978,188214,285397,440372,268069,34839,169697,437992,416150,244992,250433,433521,250205,396539,394834,396928,269839,255987,190732,39543,171725,453595,210265,183154,266350,415425,261918,294769,263756,237909,227571,230593,190788,416142,411746,192544,361659,361698,281142,416248,413815,285484,91261,405859,187258,287894,261552,428397,393829,167504,168193,388426,427285,167526,344774,211859,243261,240891,405636,417051,459465,228705,187953,263515,23130,459339,241822,428685,267276,250870,394689,425286,357102,260547,324654,272323,92039,294560,294897,269488,228886,260274,284134,326379,126220,448702,239018,418266,361276,213955,228054,261903,258547,184176,459764,457711,266368,93111,337220,232992,287152,463290,294463,95225,240067,228736,211233,263445,205943,206023,207231,169187,214271,264792,419429,169053,246688,388077,313413,385619,404144,404615,459656,465514,227967,240618,260733,35236,91997,251425,279492,363433,395035,408832,264976,211891,263844,8892,279891,233992,460049,208067,237751,253289,171101,186690,232685,458919,264740,261502,18680,460115,249646,211872,259693,467401,465202,38383,245964,395072,396557,231166,425007,265361,170743,206301,272320,238352,447748,381752,24704,91253,444765,439706,444258],false) AS dijkstra
	LEFT JOIN
	    topo_roads_noded
	ON
	    (edge = id)
	ORDER BY
	    seq
),
line as (
SELECT c.end_vid, ST_Multi(ST_LineMerge(ST_Collect(c.geom))) AS geom
	FROM dijkstra AS c
	GROUP BY c.end_vid

)

SELECT d.end_vid, ST_Length (d.geom),  d.geom AS geom
	FROM line AS d


	  
;

select * from tmp_dijkstra_test;


select * from route_node_ids;